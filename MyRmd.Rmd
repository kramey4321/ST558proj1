---
title: "ST 558 Project 1"
author: "Kristi Ramey"
date: "9/23/2021"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
## Libraries needed:
```{r message=FALSE, warning=FALSE}

#Packages needed:
#install.packages("httr")
#install.packages("jsonlite")
#Libraries needed:
library(tidyverse)
library(httr)
library(jsonlite)
```
Connect to Pokemon API
```{r message=FALSE, warning=FALSE}
pokemondumpBLUE <- GET("https://pokeapi.co/api/v2/pokemon-color/blue/")
pokemondumpMALE <- GET("https://pokeapi.co/api/v2/gender/male/")
pokemondumpFEMALE <- GET("https://pokeapi.co/api/v2/gender/female/")
pokemondumpEVOLVE <- GET("https://pokeapi.co/api/v2/evolution-chain/1/")
pokemondumpNAME <- GET("https://pokeapi.co/api/v2/")

# Try to make sense of what info is given
pokemon_blue <- fromJSON(pokemondumpBLUE$url)
pokemon_male <- fromJSON(pokemondumpMALE$url)
pokemon_female <- fromJSON(pokemondumpFEMALE$url)
pokemon_evolve <- fromJSON(pokemondumpEVOLVE$url)
pokemon_name <- fromJSON(pokemondumpNAME$url)

id <- pokemon_evolve$chain$species$name
id

```
```{r message=FALSE, warning=FALSE}
pokemondumpBLUE <- GET("https://pokeapi.co/api/v2/pokemon-color/blue/")
pokemon_blue <- fromJSON(pokemondumpBLUE$url)
df_pokemon_blue <- pokemon_blue$pokemon_species[1]
# Number of Blue Pokemon
numb_blue <- nrow(df_pokemon_blue)
numb_blue
```
```{r message=FALSE, warning=FALSE}
# Create a function to get the name of Pokemon of a certain color
color_FUN <- function(color){  
  if(color == "orange"){
    color = "red"
  }  # The API doesn't have 'orange', instead it classifies it as 'red'
  base <- ("https://pokeapi.co/api/v2/pokemon-color/")
  input <- color 
  slash <- ("/")
  api_color <- paste0(base, input, slash)
  pokemondumpCOLOR <- GET(api_color)
  pokemon_color <- fromJSON(pokemondumpCOLOR$url)
  df_pokemon_color <- pokemon_color$pokemon_species[1]
  return(df_pokemon_color)
}

color_FUN("orange") # without the logic statement to switch to red, no workie
color_FUN("black")
color_FUN("white")
```

NAME to ID

```{r message=FALSE, warning=FALSE}
#Trying to convert name to ID
pokemondumpNAME2ID <- GET("https://pokeapi.co/api/v2/pokemon/dratini")
pokemon_name2id <- fromJSON(pokemondumpNAME2ID$url)
df_pokemon_name <- pokemon_name2id$id[1]
df_pokemon_name
#It worked!!!! Dratini is 147!!!! :)
```

Now, make it into a FUNction!!   Name to ID function

```{r message=FALSE, warning=FALSE}

# Create a function to convert Pokemon name to ID 
ID_FUN <- function(poke_name){  
  base <- ("https://pokeapi.co/api/v2/pokemon/")
  input <- poke_name
  slash <- ("/")
  api_name <- paste0(base, input, slash)
  pokemondumpNAME <- GET(api_name)
  pokemon_name2id <- fromJSON(pokemondumpNAME$url)
  df_pokemon_nameid <- pokemon_name2id$id
  return(df_pokemon_nameid)
}
ID_FUN("dratini")
ID_FUN("squirtle")
```
Now, let's go to further, and find out what it can evolves into
```{r message=FALSE, warning=FALSE}

EVOLVE_FUN <- function(poke_name){  
  base <- ("https://pokeapi.co/api/v2/pokemon/")
  input <- poke_name
  slash <- ("/")
  api_name <- paste0(base, input, slash)
  pokemondumpNAME <- GET(api_name)
  pokemon_name2id <- fromJSON(pokemondumpNAME$url)
  df_pokemon_nameid <- pokemon_name2id$id  
  ID <- as.character(df_pokemon_nameid) # First have to convert name into ID
  ID
  #Now put that into the Evolve API
  base2 <- ("https://pokeapi.co/api/v2/evolution-chain/")
  api_evolve <- paste0(base2, ID, slash)
  api_evolve
  pokemondumpEVOLVE <- GET(api_evolve)
  pokemon_evolve <- fromJSON(pokemondumpEVOLVE$url)
  df_pokemon_evolve <- pokemon_evolve$chain$evolves_to$species$name
  EVOLVES <- as.character(df_pokemon_evolve)
  return(EVOLVES)
}
EVOLVE_FUN("bulbasaur")
```

Trying to drum up some quantitative data
https://pokeapi.co/api/v2/berry/{id or name}

```{r message=FALSE, warning=FALSE}
# Berry Name and Max Size

berry_FUN <- function(berry){  
  base3 <- ("https://pokeapi.co/api/v2/berry/")
  input <- berry
  slash <- ("/")
  api_berry <- paste0(base3, input, slash)
  api_berry
  pokemondumpBERRY <- GET(api_berry)
  pokemon_berry <- fromJSON(pokemondumpBERRY$url)
  df_pokemon_berry <- data.frame(pokemon_berry$name, pokemon_berry$size, pokemon_berry$max_harvest)
    return(df_pokemon_berry)
}

berry_FUN("3")
df_berry <- data.frame()
df_berry <- for(i in 1:10){
  berry_FUN(i)
}
df_berry
```




Pokemon data: https://pokeapi.co/
Render:
change input and output
rmarkdown::render(input = '_Rmd/2021-9-13-R-post.rmd', output_format = 'github_document', output_options = list(  keep_html = FALSE), output_dir = '_posts/')